## 计算机网络和因特网

### 1.1 什么是因特网

- 我们能够描述因特网的具体构成，及构成因特网的基本硬件和软件组件
- 我们能够根据为分布式应用提供服务的联网基础设施来描述因特网

#### 1.1.1 具体构成描述

​	*端系统*通过**通信链路**和**分组交换机**连接到一起。不同的链路能够以不同的速率传输数据，链路的**传输速率**为比特/秒（bit/s，或bps）度量。当一台端系统向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节。由此形成的信息包称为**分组**。这些分组通过网络发送到目的端系统，在那里被装配成初始数据。

> ​	在当今的因特网中，两种最著名的*分组*交换机类型是**路由器**和**链路层交换机**。这两种类型的交换机朝着最终目的地转发*分组*。

#### 1.1.3 什么是协议

> ​	协议定义了在两个或多个通行实体之间交换的报文的格式和顺序，以及报文发送和/或接收一条报文或其他事件所采取的动作。

​	掌握计算机网络领域知识的过程就是理解网络协议的构成、原理和工作方式的过程。

### 1.2 网络边缘

​	通常把与因特网相连的计算机和其他设备称为端系统。因为他们位于因特网的边缘，故而被称为端系统。

#### 1.2.2 物理媒体

​	物理媒体分为两种类型：引导型媒体和非引导型媒体。对于引导型媒体，电波沿着固体媒体前行，如光缆、双绞铜线或同轴电缆。对于非引导型媒体，电波在空气或外层空间中传播，例如在无线局域网或数字卫星频道中。

### 1.3 网络核心

​	我们现在更深入地研究网络核心，即由互联因特网端系统的分组交换机和链路构成的网状网路。

#### 1.3.1 分组交换

​	在各种网络应用中，端系统彼此交换**报文**。报文能够包含协议设计者需要的任何东西。为了从源端系统向目的端系统发送一个报文，源将长报文划分为较小的数据块，称之为分组。*在源和目的地之间，每个分组都通过通信链路和分组交换机传送*。

 1. 存储转发传输

    ​	多数分组交换机在链路的输入端使用存储转发传输机制。存储转发传输是指在交换机能够开始向输出链路传输该分组的第一个比特之前，必须接收到整个分组。

    ​	我们现在来考虑下列一般情况：通过有*N*条速率均为*R*的链路组成的路径（所以，在源和目的地之间有*N-1*台路由器），从源到目的地发送一个分组。应用如上相同的逻辑，我们看到端到端时延是：

    ​						d`端到端` = N*L/R

	2. 排队时延和分组丢失

    ​	每台分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有一个**输出缓存**，它用于存储路由器准备发往那条链路的分组。如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。因此，除了存储转发时延以外，分组还要承受输出缓存的**排队时延**。这些时延取决于网络的拥塞程度。因为缓存空间的大小是有限的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了。此时，将出现**分组丢失（丢包）**，到达的分组或已经排队的分组之一将被丢弃。

	3. 转发表和路由选择协议

    ​	每台路由器具有一个**转发表**，用于将目的地址（或目的地址的一部分）映射成为输出链路。当某分组到达一台路由器时，路由器检查该地址，并用这个目的地址搜索其转发表，以发现适当的出链路。路由器则将分组导向该出链路。

    ​	一个路由选择协议可以决定从每台路由器到每个目的地的最短路径，并使用这些最短路径结果来配置路由器的转发表。

#### 1.3.2 电路交换

​	通过网络链路和交换机移动数据有两种基本方法：**电路交换**和**分组交换**。

​	在电路交换网络中，在端系统间通信会话期间，预留了端系统间沿路径通信所需要的资源（缓存，链路传输速率）。在分组交换网络中，这些资源则不是预留的：会话的报文按需使用这些资源，其后果可能是不得不等待（即排队）接入通信线路。

 1. 电路交换网络中的复用

    ​	链路中的电路是通过**频分复用（FDM）**或**时分复用（TDM）**来实现的。对于FDM，链路的频谱由跨越链路创建的所有连接共享。特别是，在连接期间链路为每条连接专用一个频段。

    ​	对于一条TDM链路，时间被划分为固定期间的帧，并且每个帧又被划分为固定数量的时隙。当网络跨越一条链路创建一条连接时，网络在每个帧中为该连接指定一个时隙。一条电路的传输速率等于帧速率乘以一个时隙中的比特数量。

	2. 分组交换与电路交换的对比

    	1. 分组交换提供了比电路交换更好的带宽共享

    	2. 分组交换比电路交换更简单、更有效，实现成本更低

        电路交换不考虑需求，而预先分配了传输链路的使用，这使得已分配而并不需要的链路时间未被利用。另一方面，分组交换按需分配链路使用。链路传输能力将在所有需要在链路上传输分组的用户之间逐分组地被共享。

### 1.4 分组交换网中的时延、丢包和吞吐量

#### 1.4.1 分组交换网中的时延概念

​	当分组从一个节点（主机或路由器）沿着这条路径到后继节点，该分组在沿途的每个节点经受了几种不同类型的时延。这些时延最为重要的是**节点处理时延**、**排队时延**、**传输时延**和**传播时延**，这些时延总体累加起来是**节点总时延**。为了深入理解分组交换和计算机网络，我们必须理解这些时延的性质和重要性。

##### 时延的类型

 1. 处理时延		

    ​	检查分组首部和决定将该分组导向何处所需要的时间是**处理时延**的一部分。高速路由器的处理时延通常是微妙或更低的数量级。在这种节点处理之后，路由器将该分组引向通往路由器B链路之前的队列。

	2. 排队时延

    ​	在队列中，当分组在链路上等待传输时，它经受**排队时延**。一个特定分组的排队时延长度将取决于先期到达的正在排队等待向链路传输的分组数量。到达分组期待发现的分组数量是到达该队列的流量的强度和性质的函数。实际的排队时延可以是毫秒到微秒量级。

	3. 传输时延

    ​	用L比特表示该分组的长度，用*R bps*（即*b/s*）表示从路由器A到路由器B的链路传输速率。**传输时延**是*L/R*。*这是将所有的分组的比特推向链路（及传输，或者说发射）所需要的时间*。实际的传输时延通常在毫秒到微妙量级。

	4. 传播时延

    ​	一旦一个比忒被推向链路，该比特需要向路由器*B*传播。从该链路的起点到路由器*B*传播所需要的时间是**传播时延**。该比特以链路的传播速率传播。该传播速率取决于该链路的物理媒体，其速率范围等于或略小于光速。传播时延是*d/s*，其中*d*是路由器A到路由器*B*之间的距离，s是该链路的传播速率。在广域网中，传播时延为毫秒量级。

	5. 传输时延和传播时延的比较

    ​	**传输时延**是路由器推出分组所需要的时间，**它是分组长度和链路传输速率的函数，而与两台路由器之间的距离无关**。**传播时延**是一个比特从一台路由器传播到另一台路由器所需要的时间，**它是两台路由器之间距离的函数，而与分组长度或链路传输速率无关**。

    这些时延成分所起的作用可能会有很大的不同。例如，对于连接两台位于同一个大学校园的路由器的链路而言，传播时延可能是微不足道的（例如，及微妙）；然而，对于由同步卫星链路互联的两台路由器来说，传播时延是几百微妙，能够成为节点总时延的主要成分。